* [什么是 SQL 注入？如何预防 SQL 注入？](#什么是-sql-注入如何预防-sql-注入)
* [fork 和 vfork](#fork-和-vfork)
* [Web 请求页面的全过程](#web-请求页面的全过程)

### 什么是 SQL 注入？如何预防 SQL 注入？

**什么是 SQL 注入**

所谓 SQL 注入式攻击，就是攻击者把 SQL 命令插入到 Web 表单的输入域或页面请求的查询字符串，欺骗服务器恶意执行 SQL 命令，**具
体来说，它就是利用现有程序，将恶意的 SQL 命令注入到后台数据库引擎上的能力，它可以通过在 Web 表单中输入恶意 SQL 语句得到一个存在安全漏洞的网站上的数据库，而不是按照设计者意图去执行 SQL 语句**

**如何防范 SQL 注入(针对 JSP)**

在利用表单输入的内容构造 SQL 命令之前，把所有输入内容过滤一番就可以了

- 使用正则表达式过滤传入的参数
- 字符串过滤
- JSP 中调用该函数检查是否包含非法字符
- JSP 页面判断代码

凡涉及到执行的 SQL 语句中有变量时，用 JDBC 提供的 PreparedStatement 就可以，切记不要用拼接字符串的方法就可以了

### fork 和 vfork

fork 和 vfork 都是创建一个进程，但是有一下区别

- fork 子进程拷贝父进程的数据段、代码段，vfork 子进程和父进程则共享数据段
- fork 父子进程执行次序不确定，vfork 保证子进程先运行，在调用 exec 或 exit 之前与父进程数据是共享的，在它调用 exec 或 exit 之后父进程才可能被调度运行
- vfork 保证子进程先运行，在它调用 exec 或 exit 之后父进程才可能被调度运行，如果在调用这两个函数之前子进程依赖于父进程的进一步动作，则会导致死锁

进程创建 fork，此奇妙之处在于它被调用一次，却返回两次，它可能有三种不同的返回值

- 在父进程中，fork 返回新创建的子进程的 PID
- 在子进程中，fork 返回 0
- 如果出现错误，fork 返回一个负值

**操作系统创建进程的步骤**

- 申请新的 PCB
- 为新进程分配资源
- 初始化 PCB
- 将新进程插入到就绪队列中

**fork 调用底层**

- fork、vfork、_clone -> clone -> do_fork -> copy_process ->
  - dup_task_struct 为新进程创建与父进程值相同的内核栈，thread_info 和 task_struct，此时父子进程描述符相同
  - check 当前用户拥有进程数未超过给它分配的资源限制
  - 区别父子进程描述符，部分进程描述符成员清零或设置
  - set 子进程 state 为 TASK_UNINTERRUPTIBLE
  - copy_flags 更新 task_struct 中的 flags，进程是否拥有超级用户权限清零，进程还没调用 exec 函数表示设置
  - alloc_pid 为新进程分配有效的 PID
  - 根据 clone 参数，copy_process 拷贝或共享打开的文件，进程地址空间等
  - copy_process 扫尾并返回指向子进程的指针

### Web 请求页面的全过程

对于 URL 请求页面全过程，具体可分为 5 步

- 先找到 DNS

  - 当一个用户在地址栏输入 www.qq.com 时，DNS解析大致有十个过程
  - 浏览器先检查自身缓存中有没有被解析过的这个域名对应的 IP 地址，若果有解析结束
  - 如果浏览器缓存中没有(查找未命中)，浏览器会检查操作系统缓存中有没有对应的已解析过的结果，而操作系统也有一个域名解析的过程，在 windows 中可以通过一个叫 hosts 的文件来设置，
  - 如果你在这里指定了一个域名对应的 IP 地址，那浏览器会首先使用这个 IP 地址
  - 如果至此还未命中域名，才会真正请求本地域名服务器(LDNS)，来解析这个域名
  - 如果 LDNS 还未命中，就直接跳到根域名服务器请求解析
  - 根域名服务器返回给 LDNS 一个所查询的主域名服务器
  - 此时 LDNS 再发送请求给上一步返回的根域名服务器
  - 接受请求的根域名服务器查找并返回这个域名对应的 IP 地址，这个 IP 地址即是网站注册的域名服务器，然后再根据映射关系找到目标 IP 返回给 LDNS
  - LDNS 缓存这个域名和对应的 IP，并且把解析的结果返回给用户，用户根据 TTL 值缓存到本地缓存中，域名解析过程结束

- 建立 TCP 连接

建立 TCP 连接时需要一个四元组 <源 IP，目的 IP，源端口，目的端口>，此时引发三次握手，TCP/IP 建立连接后，浏览器会向服务器发送 HTTP 请求

**三次握手全过程**

- 首先客户端调用 connect 函数发起连接，向服务器发送连接请求报文，将 SYN 标识位置置 1，序列号 seq 置 x，然后客户端进入 SYN_SEND 状态
- 服务器对收到来自客户端的 SYN 报文段进行确认，将 SYN 标识置 1，ACK 置 1，序列号 seq 置 y，此时确认号 ack 为 x+1，然后服务端进入 SYN_RECV 状态，这个状态被称为 半连接状态
- 客户端再对服务器对客户端的连接请求的确认进行确认，将 ACK 置 1，seq 为 x+1，确认号 ack y+1 发向服务器，最后客户端与服务器都进入 ESTABLISHED 状态即连接状态

- 发送 HTTP 报文
- 接受 HTTP 报文
- 浏览器解析显示
